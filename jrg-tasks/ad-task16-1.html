<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <title>ad-task16-1:图片懒加载</title>
    <style>
        img{
            display: block;
            max-width: 700px;
        }
    </style>
</head>
<body>
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i4.buimg.com/567571/b703b63d1f8642f6.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i1.piimg.com/567571/8ebd3553ea6374f9.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i1.piimg.com/567571/147194b64f6f5239.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i4.buimg.com/567571/96ebd4c38b68e528.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i2.muimg.com/567571/38f6b3860cab5725.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i4.buimg.com/567571/d305e3e5a71ad5b1.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i2.muimg.com/567571/b84cf29b4d57b0dc.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i1.piimg.com/567571/499c54ba1b85e7d0.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i2.muimg.com/567571/24420c854f4110fc.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i2.muimg.com/567571/6240fc1f12f4db2d.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i2.muimg.com/567571/25228fde86b92369.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i1.piimg.com/567571/2eea4371a75794fb.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i2.muimg.com/567571/0f3272f29c95374c.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i1.piimg.com/567571/a4d9de53d4d31d97.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i2.muimg.com/567571/e02c7bb0a89ec8c8.jpg" alt="">
    <img src="http://i1.piimg.com/567571/1846d6e0fc5e50b7.gif" data-src="http://i4.buimg.com/567571/27910ac786f029c1.jpg" alt="">
    
    <script src="jquery-3.2.0.min.js"></script>
    <script>
    function isVisible($node){
        var windowHeight = $(window).height();
        var scrollTop = $(window).scrollTop();
        var offsetTop = $node.offset().top;
        var nodeHeight = $node.outerHeight(true);
        if(scrollTop > offsetTop-windowHeight && scrollTop < offsetTop+nodeHeight){
            return true;
        }
        else{
            return false;
        }
    }
    $(window).on('load',check);    
    $(window).on('scroll',check);

    function check(){
        $('img').not('.loaded').each(function(){
            if(isVisible($(this))){
                show($(this));
            }
        });
    }

    function show($img){
        //使用延时函数模拟慢网速测试用，正式代码应将里面的代码从setTimeout放出来
        setTimeout(function() 
        {$img.addClass('loaded');
        var imgSrc = $img.attr('data-src');
        $img.attr('src',imgSrc);},1000);
    } 
    </script>
</body>